<div id="dashboardContainer" class="w-full h-full overflow-hidden px-2 sm:px-4 md:px-8 lg:px-16">
    <!-- Header with Fullscreen Button -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-3">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Dashboard Statistik Dokumen</h1>
        <div class="flex flex-row flex-wrap items-center gap-2">
            <a href="/documents" class="px-4 py-2 border-2 border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition flex items-center space-x-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span>Daftar Dokumen</span>
            </a>
            <button id="fullscreenBtn" class="px-4 py-2 rounded-lg text-white font-medium hover:opacity-90 transition flex items-center space-x-2" style="background-color: #00341f">
                <svg id="fullscreenIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                </svg>
                <span id="fullscreenText">Mode Fullscreen</span>
            </button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-6"><%- include('partials/stats-cards') %></div>

    <!-- Dashboard Charts -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Workflow Stage Distribution -->
        <div class="bg-white rounded-xl shadow-xl p-4 sm:p-6">
            <h3 class="text-lg sm:text-xl font-semibold text-gray-800 mb-4">Distribusi per Tahapan</h3>
            <div class="relative h-48 sm:h-64 md:h-72 lg:h-80 xl:h-96">
                <canvas id="workflowChart"></canvas>
            </div>
        </div>

        <!-- Status & Reviewer Distribution -->
        <div class="bg-white rounded-xl shadow-xl p-4 sm:p-6">
            <h3 class="text-lg sm:text-xl font-semibold text-gray-800 mb-4">Status & Distribusi Dokumen</h3>
            <div class="relative h-48 sm:h-64 md:h-72 lg:h-80 xl:h-96">
                <canvas id="statusChart"></canvas>
            </div>
        </div>
    </div>
</div>

<style>
    /* Fullscreen styles - completely remove scrollbars */
    :fullscreen,
    :-webkit-full-screen,
    :-moz-full-screen {
        overflow: hidden !important;
    }

    :fullscreen body,
    :-webkit-full-screen body,
    :-moz-full-screen body {
        overflow: hidden !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    #dashboardContainer:fullscreen {
        width: 100vw;
        height: 100vh;
        overflow: hidden !important;
        padding: 2rem 3.5rem;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        background-color: #f2f2f2 !important;
    }

    #dashboardContainer:-webkit-full-screen {
        width: 100vw;
        height: 100vh;
        overflow: hidden !important;
        padding: 2rem 3.5rem;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        background-color: #f2f2f2 !important;
    }

    #dashboardContainer:-moz-full-screen {
        width: 100vw;
        height: 100vh;
        overflow: hidden !important;
        padding: 2rem 3.5rem;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        background-color: #f2f2f2 !important;
    }

    /* Header in fullscreen - compact */
    #dashboardContainer:fullscreen > div:first-child,
    #dashboardContainer:-webkit-full-screen > div:first-child,
    #dashboardContainer:-moz-full-screen > div:first-child {
        flex-shrink: 0;
        margin-bottom: 0.75rem;
    }

    #dashboardContainer:fullscreen > div:first-child h1,
    #dashboardContainer:-webkit-full-screen > div:first-child h1,
    #dashboardContainer:-moz-full-screen > div:first-child h1 {
        font-size: 1.75rem;
    }

    /* Stats cards grid in fullscreen - compact */
    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-3,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-3,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-3 {
        flex: 0 0 auto;
        height: 16vh;
        margin-bottom: 0.75rem;
        gap: 1.25rem;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-3 > div,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-3 > div,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-3 > div {
        padding: 1rem;
        height: 100%;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-3 h3,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-3 h3,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-3 h3 {
        font-size: 2.5rem;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-3 svg,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-3 svg,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-3 svg {
        width: 2.5rem;
        height: 2.5rem;
    }
    gap: 1.25rem;
    /* Charts grid in fullscreen - maximize space */
    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-2,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-2,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-2 {
        flex: 1;
        height: auto;
        min-height: 0;
        gap: 0.75rem;
        margin-bottom: 0;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-2 > div,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div {
        height: 100%;
        display: flex;
        flex-direction: column;
        padding: 1rem;
        max-height: 100%;
        overflow: hidden;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-2 > div h3,
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div h3,
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div h3 {
        font-size: 1.125rem;
        margin-bottom: 0.5rem;
        flex-shrink: 0;
    }

    #dashboardContainer:fullscreen .grid.grid-cols-1.md\\:grid-cols-2 > div > div[style*='height'],
    #dashboardContainer:-webkit-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div > div[style*='height'],
    #dashboardContainer:-moz-full-screen .grid.grid-cols-1.md\\:grid-cols-2 > div > div[style*='height'] {
        flex: 1;
        height: auto !important;
        max-height: 100%;
        position: relative;
    }

    #dashboardContainer:fullscreen canvas,
    #dashboardContainer:-webkit-full-screen canvas,
    #dashboardContainer:-moz-full-screen canvas {
        max-width: 100% !important;
        max-height: 100% !important;
    }
</style>

<script>
    // Fullscreen functionality
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    const dashboardContainer = document.getElementById('dashboardContainer');
    const fullscreenIcon = document.getElementById('fullscreenIcon');
    const fullscreenText = document.getElementById('fullscreenText');

    fullscreenBtn.addEventListener('click', function () {
        if (!document.fullscreenElement) {
            // Fullscreen hanya dashboardContainer, bukan seluruh document
            dashboardContainer
                .requestFullscreen()
                .then(() => {
                    fullscreenIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>';
                    fullscreenText.textContent = 'Keluar Fullscreen';
                })
                .catch((err) => {
                    alert('Error attempting to enable fullscreen: ' + err.message);
                });
        } else {
            document.exitFullscreen();
            fullscreenIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>';
            fullscreenText.textContent = 'Mode Fullscreen';
        }
    });

    // Listen for fullscreen changes
    document.addEventListener('fullscreenchange', function () {
        if (!document.fullscreenElement) {
            fullscreenIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>';
            fullscreenText.textContent = 'Mode Fullscreen';
        }
    });
</script>

<!-- Initialize Charts -->
<%- include('partials/charts-init') %>
